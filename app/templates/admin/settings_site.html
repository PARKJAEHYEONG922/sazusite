{% extends "layout/admin_base.html" %}

{% block page_title %}ì‚¬ì´íŠ¸ ì„¤ì •{% endblock %}

{% block admin_content %}
<!-- ì•Œë¦¼ ë©”ì‹œì§€ -->
{% if success %}
<div class="alert alert-success">
    <span class="alert-icon">âœ“</span>
    <span class="alert-content">{{ success }}</span>
</div>
{% endif %}

{% if error %}
<div class="alert alert-error">
    <span class="alert-icon">âœ•</span>
    <span class="alert-content">{{ error }}</span>
</div>
{% endif %}

<form method="POST" action="/admin/settings/site" enctype="multipart/form-data">
    <!-- ê¸°ë³¸ ì •ë³´ ì„¹ì…˜ -->
    <div class="admin-section">
        <div class="admin-section-header">
            <div>
                <h2 class="admin-section-title">ê¸°ë³¸ ì •ë³´</h2>
                <p class="admin-section-description">ì‚¬ì´íŠ¸ì˜ ê¸°ë³¸ì ì¸ ì •ë³´ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤</p>
            </div>
        </div>

        <div class="form-grid form-grid-2">
            <div class="form-group">
                <label class="form-label">ì‚¬ì´íŠ¸ ì´ë¦„ <span class="required">*</span></label>
                <input type="text" name="site_name" class="form-input"
                       value="{{ config.site_name if config else 'ëª…ì›”í—Œ' }}" required>
            </div>

            <div class="form-group">
                <label class="form-label">ì‚¬ì´íŠ¸ URL</label>
                <input type="url" name="site_url" class="form-input"
                       value="{{ config.site_url if config and config.site_url else '' }}"
                       placeholder="https://yourdomain.com">
                <span class="form-hint">SEOì™€ ì†Œì…œ ê³µìœ ì— ì‚¬ìš©ë©ë‹ˆë‹¤</span>
            </div>

            <div class="form-group">
                <label class="form-label">ì‚¬ì´íŠ¸ ë¡œê³  ì´ë¯¸ì§€</label>
                <input type="file" id="site_logo_file" name="site_logo_file" class="form-file-input"
                       accept="image/*" onchange="previewImage(this, 'logo_preview')">
                <label for="site_logo_file" class="form-file-label">ğŸ“ íŒŒì¼ ì„ íƒ</label>
                {% if config and config.site_logo %}
                <div class="form-hint">í˜„ì¬: {{ config.site_logo }}</div>
                <div class="image-preview-wrapper mt-2">
                    <div class="image-preview-header">ğŸ“Œ ìˆ˜ì • ì „</div>
                    <div class="image-preview-item logo-preview">
                        <img src="{{ config.site_logo }}" alt="ìˆ˜ì • ì „ ë¡œê³ ">
                    </div>
                </div>
                {% endif %}
                <div id="logo_preview" class="mt-2"></div>
                <span class="form-hint">ê¶Œì¥ í¬ê¸°: ê°€ë¡œ 150px</span>
            </div>

            <div class="form-group">
                <label class="form-label">ì‚¬ì´íŠ¸ íŒŒë¹„ì½˜</label>
                <input type="file" id="site_favicon_file" name="site_favicon_file" class="form-file-input"
                       accept=".ico,.png,image/x-icon,image/png" onchange="previewImage(this, 'favicon_preview')">
                <label for="site_favicon_file" class="form-file-label">ğŸ“ íŒŒì¼ ì„ íƒ</label>
                {% if config and config.site_favicon %}
                <div class="form-hint">í˜„ì¬: {{ config.site_favicon }}</div>
                <div class="image-preview-wrapper mt-2">
                    <div class="image-preview-header">ğŸ“Œ ìˆ˜ì • ì „</div>
                    <div class="image-preview-item favicon-preview">
                        <img src="{{ config.site_favicon }}" alt="ìˆ˜ì • ì „ íŒŒë¹„ì½˜">
                    </div>
                </div>
                {% endif %}
                <div id="favicon_preview" class="mt-2"></div>
                <span class="form-hint">ë¸Œë¼ìš°ì € íƒ­ì— í‘œì‹œë¨ (32x32px, .ico ë˜ëŠ” .png)</span>
            </div>

            <div class="form-group full-width">
                <label class="form-label">ë©”ì¸ íƒ€ì´í‹€ <span class="required">*</span></label>
                <input type="text" name="main_title" class="form-input"
                       value="{{ config.main_title if config else '' }}" required>
            </div>

            <div class="form-group full-width">
                <label class="form-label">ë©”ì¸ ì„œë¸Œíƒ€ì´í‹€ <span class="required">*</span></label>
                <textarea name="main_subtitle" class="form-textarea" required>{{ config.main_subtitle if config else '' }}</textarea>
            </div>

            <div class="form-group full-width">
                <label class="form-label">í‘¸í„° í…ìŠ¤íŠ¸ <span class="required">*</span></label>
                <textarea name="footer_text" class="form-textarea" required>{{ config.footer_text if config else '' }}</textarea>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ë°°ë„ˆ ì„¹ì…˜ -->
    <div class="admin-section">
        <div class="admin-section-header">
            <div>
                <h2 class="admin-section-title">ë©”ì¸ ë°°ë„ˆ ì„¤ì •</h2>
                <p class="admin-section-description">ë©”ì¸ ìŠ¬ë¼ì´ë” ë°°ë„ˆ (PC: 21:9 ë¹„ìœ¨, ëª¨ë°”ì¼: 4:3 ë¹„ìœ¨)</p>
            </div>
        </div>

        <div class="tab-navigation">
            <button type="button" class="tab-button active" onclick="switchTab(event, 'banner-1')">ë°°ë„ˆ 1</button>
            <button type="button" class="tab-button" onclick="switchTab(event, 'banner-2')">ë°°ë„ˆ 2</button>
            <button type="button" class="tab-button" onclick="switchTab(event, 'banner-3')">ë°°ë„ˆ 3</button>
            <button type="button" class="tab-button" onclick="switchTab(event, 'banner-4')">ë°°ë„ˆ 4</button>
        </div>

        {% for i in range(1, 5) %}
        <div id="banner-{{ i }}" class="tab-content {% if i == 1 %}active{% endif %}">
            <div class="banner-group">
                <div class="banner-item">
                    <div class="banner-item-header">
                        <h3 class="banner-item-title">ë°°ë„ˆ {{ i }} ì´ë¯¸ì§€</h3>
                    </div>

                    <div class="form-grid form-grid-2">
                        <div class="form-group">
                            <label class="form-label">ëª¨ë°”ì¼ ì´ë¯¸ì§€ (4:3 ë¹„ìœ¨)</label>
                            <input type="file" id="banner_file_{{ i }}" name="banner_file_{{ i }}"
                                   class="form-file-input" accept="image/*"
                                   onchange="previewImage(this, 'banner_mobile_preview_{{ i }}')">
                            <label for="banner_file_{{ i }}" class="form-file-label">ğŸ“ íŒŒì¼ ì„ íƒ</label>
                            {% if config and config['banner_image_' + i|string] %}
                            <div class="form-hint">í˜„ì¬: {{ config['banner_image_' + i|string] }}</div>
                            <!-- í˜„ì¬ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° -->
                            <div class="image-preview-wrapper mt-2">
                                <div class="banner-preview-card">
                                    <div class="banner-preview-header">ğŸ“Œ ìˆ˜ì • ì „ - ëª¨ë°”ì¼ (4:3)</div>
                                    <div class="banner-preview-image mobile">
                                        <img src="{{ config['banner_image_' + i|string] }}" alt="ìˆ˜ì • ì „ ëª¨ë°”ì¼ ë°°ë„ˆ {{ i }}">
                                    </div>
                                </div>
                            </div>
                            {% endif %}
                            <div id="banner_mobile_preview_{{ i }}" class="mt-2"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">PC ì´ë¯¸ì§€ (21:9 ë¹„ìœ¨)</label>
                            <input type="file" id="banner_pc_file_{{ i }}" name="banner_pc_file_{{ i }}"
                                   class="form-file-input" accept="image/*"
                                   onchange="previewImage(this, 'banner_pc_preview_{{ i }}')">
                            <label for="banner_pc_file_{{ i }}" class="form-file-label">ğŸ“ íŒŒì¼ ì„ íƒ</label>
                            {% if config and config['banner_image_pc_' + i|string] %}
                            <div class="form-hint">í˜„ì¬: {{ config['banner_image_pc_' + i|string] }}</div>
                            <!-- í˜„ì¬ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° -->
                            <div class="image-preview-wrapper mt-2">
                                <div class="banner-preview-card">
                                    <div class="banner-preview-header">ğŸ“Œ ìˆ˜ì • ì „ - PC (21:9)</div>
                                    <div class="banner-preview-image pc">
                                        <img src="{{ config['banner_image_pc_' + i|string] }}" alt="ìˆ˜ì • ì „ PC ë°°ë„ˆ {{ i }}">
                                    </div>
                                </div>
                            </div>
                            {% endif %}
                            <div id="banner_pc_preview_{{ i }}" class="mt-2"></div>
                        </div>
                    </div>
                </div>

                <div class="banner-item">
                    <div class="banner-item-header">
                        <h3 class="banner-item-title">ë°°ë„ˆ {{ i }} í…ìŠ¤íŠ¸</h3>
                    </div>

                    <div class="form-grid form-grid-2">
                        <div class="form-group">
                            <label class="form-label">ì œëª©</label>
                            <input type="text" name="banner_title_{{ i }}" class="form-input"
                                   value="{{ config['banner_title_' + i|string] if config else '' }}">
                        </div>

                        <div class="form-group">
                            <label class="form-label">ë¶€ì œëª©</label>
                            <input type="text" name="banner_subtitle_{{ i }}" class="form-input"
                                   value="{{ config['banner_subtitle_' + i|string] if config else '' }}">
                        </div>

                        <div class="form-group full-width">
                            <label class="form-label">ì„¤ëª…</label>
                            <textarea name="banner_description_{{ i }}" class="form-textarea">{{ config['banner_description_' + i|string] if config else '' }}</textarea>
                        </div>

                        <div class="form-group full-width">
                            <label class="form-label">ë§í¬ URL</label>
                            <input type="text" name="banner_link_{{ i }}" class="form-input"
                                   value="{{ config['banner_link_' + i|string] if config else '' }}">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- ì„œë¸Œ ë°°ë„ˆ ì„¹ì…˜ -->
    <div class="admin-section">
        <div class="admin-section-header">
            <div>
                <h2 class="admin-section-title">ì„œë¸Œ ë°°ë„ˆ ì„¤ì •</h2>
                <p class="admin-section-description">ì„œë¹„ìŠ¤ ì¹´ë“œ ì˜ì—­ (3:4 ë¹„ìœ¨, ì´ë¯¸ì§€ ë˜ëŠ” ë¹„ë””ì˜¤)</p>
            </div>
        </div>

        <div class="tab-navigation">
            <button type="button" class="tab-button active" onclick="switchTab(event, 'sub-1')">ì„œë¸Œ 1</button>
            <button type="button" class="tab-button" onclick="switchTab(event, 'sub-2')">ì„œë¸Œ 2</button>
            <button type="button" class="tab-button" onclick="switchTab(event, 'sub-3')">ì„œë¸Œ 3</button>
            <button type="button" class="tab-button" onclick="switchTab(event, 'sub-4')">ì„œë¸Œ 4</button>
        </div>

        {% for i in range(1, 5) %}
        <div id="sub-{{ i }}" class="tab-content {% if i == 1 %}active{% endif %}">
            <div class="banner-item">
                <div class="banner-item-header">
                    <h3 class="banner-item-title">ì„œë¸Œ ë°°ë„ˆ {{ i }}</h3>
                </div>

                <div class="form-grid form-grid-2">
                    <div class="form-group full-width">
                        <label class="form-label">ì´ë¯¸ì§€/ì˜ìƒ (3:4 ë¹„ìœ¨)</label>
                        <input type="file" id="sub_banner_file_{{ i }}" name="sub_banner_file_{{ i }}"
                               class="form-file-input" accept="image/*,video/mp4,video/webm"
                               onchange="previewImage(this, 'sub_banner_preview_{{ i }}')">
                        <label for="sub_banner_file_{{ i }}" class="form-file-label">ğŸ“ íŒŒì¼ ì„ íƒ</label>
                        {% if config and config['sub_banner_image_' + i|string] %}
                        <div class="form-hint">í˜„ì¬: {{ config['sub_banner_image_' + i|string] }}</div>
                        <!-- ë¯¸ë¦¬ë³´ê¸° -->
                        <div class="image-preview-wrapper mt-2">
                            <div class="image-preview-header">ğŸ“Œ ìˆ˜ì • ì „</div>
                            <div class="image-preview-item sub-banner">
                                {% if config['sub_banner_image_' + i|string].endswith(('.mp4', '.webm')) %}
                                <video src="{{ config['sub_banner_image_' + i|string] }}" controls></video>
                                {% else %}
                                <img src="{{ config['sub_banner_image_' + i|string] }}" alt="ìˆ˜ì • ì „ ì„œë¸Œ ë°°ë„ˆ {{ i }}">
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}
                        <div id="sub_banner_preview_{{ i }}" class="mt-2"></div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ì œëª©</label>
                        <input type="text" name="sub_banner_title_{{ i }}" class="form-input"
                               value="{{ config['sub_banner_title_' + i|string] if config else '' }}">
                    </div>

                    <div class="form-group">
                        <label class="form-label">ë¶€ì œëª©</label>
                        <input type="text" name="sub_banner_subtitle_{{ i }}" class="form-input"
                               value="{{ config['sub_banner_subtitle_' + i|string] if config else '' }}">
                    </div>

                    <div class="form-group full-width">
                        <label class="form-label">ì„¤ëª…</label>
                        <textarea name="sub_banner_description_{{ i }}" class="form-textarea">{{ config['sub_banner_description_' + i|string] if config else '' }}</textarea>
                    </div>

                    <div class="form-group full-width">
                        <label class="form-label">ë§í¬ URL</label>
                        <input type="text" name="sub_banner_link_{{ i }}" class="form-input"
                               value="{{ config['sub_banner_link_' + i|string] if config else '' }}">
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- ì• ë“œì„¼ìŠ¤ ì„¹ì…˜ -->
    <div class="admin-section">
        <div class="admin-section-header">
            <div>
                <h2 class="admin-section-title">ì• ë“œì„¼ìŠ¤ ì„¤ì •</h2>
                <p class="admin-section-description">Google AdSense ê´‘ê³  ì„¤ì •</p>
            </div>
        </div>

        <div class="form-grid form-grid-3">
            <div class="form-group full-width">
                <label class="form-label">ì• ë“œì„¼ìŠ¤ í´ë¼ì´ì–¸íŠ¸ ID</label>
                <input type="text" name="adsense_client_id" class="form-input"
                       value="{{ config.adsense_client_id if config and config.adsense_client_id else '' }}"
                       placeholder="ca-pub-XXXXXXXXXXXXXXXX">
                <span class="form-hint">ì˜ˆ: ca-pub-1234567890123456</span>
            </div>

            <div class="form-group">
                <label class="form-label">ë©”ì¸ í˜ì´ì§€ ê´‘ê³  ìŠ¬ë¡¯</label>
                <input type="text" name="adsense_slot_main" class="form-input"
                       value="{{ config.adsense_slot_main if config and config.adsense_slot_main else '' }}"
                       placeholder="1234567890">
            </div>

            <div class="form-group">
                <label class="form-label">ê²°ê³¼ í˜ì´ì§€ ê´‘ê³  ìŠ¬ë¡¯</label>
                <input type="text" name="adsense_slot_result" class="form-input"
                       value="{{ config.adsense_slot_result if config and config.adsense_slot_result else '' }}"
                       placeholder="0987654321">
            </div>
        </div>
    </div>

    <!-- í•˜ë‹¨ ë²„íŠ¼ -->
    <div class="form-actions">
        <div></div>
        <div class="btn-group">
            <button type="button" class="btn btn-secondary" onclick="window.location.href='/admin/dashboard'">
                ì·¨ì†Œ
            </button>
            <button type="submit" class="btn btn-primary">
                ğŸ’¾ ì €ì¥
            </button>
        </div>
    </div>
</form>
{% endblock %}
